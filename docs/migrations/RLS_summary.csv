TIPO,TABLA/BUCKET,POLÍTICA,OPERACIÓN,ROLES PERMITIDOS,TIPO DE ACCESO,NIVEL DE SEGURIDAD,CONDICIÓN USING,CONDICIÓN WITH CHECK
public,chats,chats_participants_insert,➕ INSERTAR,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN VERIFICACIÓN,Sin condición USING,((auth.uid() = a_user_id) OR (auth.uid() = b_user_id))
public,chats,chats_participants_select,🔍 LECTURA,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN USANDO,((auth.uid() = a_user_id) OR (auth.uid() = b_user_id)),Sin condición WITH CHECK
public,chats,chats_participants_update,✏️ ACTUALIZAR,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN AMBAS,((auth.uid() = a_user_id) OR (auth.uid() = b_user_id)),((auth.uid() = a_user_id) OR (auth.uid() = b_user_id))
public,interactions,interactions_self_all,🔄 TODAS LAS OPERACIONES,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN AMBAS,(auth.uid() = user_id),(auth.uid() = user_id)
public,item_photos,item_photos_owner_likers_and_chat_participants,🔄 TODAS LAS OPERACIONES,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN AMBAS,"((EXISTS ( SELECT 1
   FROM items i
  WHERE ((i.id = item_photos.item_id) AND (i.owner_id = auth.uid())))) OR (EXISTS ( SELECT 1
   FROM interactions inter
  WHERE ((inter.item_id = item_photos.item_id) AND (inter.user_id = auth.uid()) AND (inter.action = 'like'::text)))) OR (EXISTS ( SELECT 1
   FROM (items i
     JOIN chats c ON ((c.item_id = i.id)))
  WHERE ((i.id = item_photos.item_id) AND ((c.a_user_id = auth.uid()) OR (c.b_user_id = auth.uid()))))))","(EXISTS ( SELECT 1
   FROM items i
  WHERE ((i.id = item_photos.item_id) AND (i.owner_id = auth.uid()))))"
public,item_photos,item_photos_owner_delete,🗑️ ELIMINAR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN USANDO,"(EXISTS ( SELECT 1
   FROM items i
  WHERE ((i.id = item_photos.item_id) AND (i.owner_id = auth.uid()))))",Sin condición WITH CHECK
public,item_photos,item_photos_owner_insert,➕ INSERTAR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN VERIFICACIÓN,Sin condición USING,"((auth.uid() IS NOT NULL) AND (EXISTS ( SELECT 1
   FROM items i
  WHERE ((i.id = item_photos.item_id) AND (i.owner_id = auth.uid())))))"
public,item_photos,item_photos_owner_select,🔍 LECTURA,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN USANDO,"(EXISTS ( SELECT 1
   FROM items i
  WHERE ((i.id = item_photos.item_id) AND (i.owner_id = auth.uid()))))",Sin condición WITH CHECK
public,item_photos,item_photos_owner_update,✏️ ACTUALIZAR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN AMBAS,"(EXISTS ( SELECT 1
   FROM items i
  WHERE ((i.id = item_photos.item_id) AND (i.owner_id = auth.uid()))))","(EXISTS ( SELECT 1
   FROM items i
  WHERE ((i.id = item_photos.item_id) AND (i.owner_id = auth.uid()))))"
public,items,items_owner_insert_update_delete,🔄 TODAS LAS OPERACIONES,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN AMBAS,(auth.uid() = owner_id),(auth.uid() = owner_id)
public,items,items_chat_participants_select,🔍 LECTURA,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN USANDO,"((auth.uid() = owner_id) OR (EXISTS ( SELECT 1
   FROM chats c
  WHERE ((c.item_id = items.id) AND ((auth.uid() = c.a_user_id) OR (auth.uid() = c.b_user_id))))))",Sin condición WITH CHECK
public,messages,messages_participants_insert,➕ INSERTAR,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN VERIFICACIÓN,Sin condición USING,"(EXISTS ( SELECT 1
   FROM chats c
  WHERE ((c.id = messages.chat_id) AND ((auth.uid() = c.a_user_id) OR (auth.uid() = c.b_user_id)))))"
public,messages,messages_participants_select,🔍 LECTURA,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN USANDO,"(EXISTS ( SELECT 1
   FROM chats c
  WHERE ((c.id = messages.chat_id) AND ((auth.uid() = c.a_user_id) OR (auth.uid() = c.b_user_id)))))",Sin condición WITH CHECK
public,messages,messages_participants_update,✏️ ACTUALIZAR,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN AMBAS,"(EXISTS ( SELECT 1
   FROM chats c
  WHERE ((c.id = messages.chat_id) AND ((auth.uid() = c.a_user_id) OR (auth.uid() = c.b_user_id)))))","(EXISTS ( SELECT 1
   FROM chats c
  WHERE ((c.id = messages.chat_id) AND ((auth.uid() = c.a_user_id) OR (auth.uid() = c.b_user_id)))))"
public,profiles,profiles_self_insert,➕ INSERTAR,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN VERIFICACIÓN,Sin condición USING,(auth.uid() = user_id)
public,profiles,profiles_chat_participants_select,🔍 LECTURA,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN USANDO,"((auth.uid() = user_id) OR (EXISTS ( SELECT 1
   FROM chats c
  WHERE (((c.a_user_id = auth.uid()) AND (c.b_user_id = profiles.user_id)) OR ((c.b_user_id = auth.uid()) AND (c.a_user_id = profiles.user_id))))))",Sin condición WITH CHECK
public,profiles,profiles_self_update,✏️ ACTUALIZAR,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN AMBAS,(auth.uid() = user_id),(auth.uid() = user_id)
public,push_tokens,push_tokens_self_all,🔄 TODAS LAS OPERACIONES,public,⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN AMBAS,(auth.uid() = user_id),(auth.uid() = user_id)
storage,objects,storage_avatars_owner_delete 1oj01fe_0,🗑️ ELIMINAR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN USANDO,((bucket_id = 'avatars'::text) AND ((auth.uid())::text = (storage.foldername(name))[2])),Sin condición WITH CHECK
storage,objects,Owners can delete item photos 13j4whn_0,🗑️ ELIMINAR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN USANDO,"((bucket_id = 'item-photos'::text) AND ((auth.uid())::text = (regexp_match(name, '^item-photos/([^/]+)/'::text))[1]) AND (EXISTS ( SELECT 1
   FROM items
  WHERE (((items.id)::text = (regexp_match(objects.name, '^item-photos/[^/]+/([^_]+)_'::text))[1]) AND (items.owner_id = auth.uid())))))",Sin condición WITH CHECK
storage,objects,Owners can upload item photos 13j4whn_0,➕ SUBIR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN VERIFICACIÓN,Sin condición USING,"((bucket_id = 'item-photos'::text) AND ((auth.uid())::text = (regexp_match(name, '^item-photos/([^/]+)/'::text))[1]) AND (EXISTS ( SELECT 1
   FROM items
  WHERE (((items.id)::text = (regexp_match(objects.name, '^item-photos/[^/]+/([^_]+)_'::text))[1]) AND (items.owner_id = auth.uid())))))"
storage,objects,storage_avatars_owner_insert 1oj01fe_0,➕ SUBIR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN VERIFICACIÓN,Sin condición USING,((bucket_id = 'avatars'::text) AND ((auth.uid())::text = (storage.foldername(name))[2]))
storage,objects,storage_avatars_owner_select 1oj01fe_0,🔍 DESCARGAR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN USANDO,(bucket_id = 'avatars'::text),Sin condición WITH CHECK
storage,objects,Public read access for available item photos 13j4whn_0,🔍 DESCARGAR,"anon, authenticated",⚠️ ACCESO PÚBLICO,✅ RESTRICCIÓN EN USANDO,(bucket_id = 'item-photos'::text),Sin condición WITH CHECK
storage,objects,Owners can list their item photos 13j4whn_0,🔍 DESCARGAR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN USANDO,"((bucket_id = 'item-photos'::text) AND ((auth.uid())::text = (regexp_match(name, '^item-photos/([^/]+)/'::text))[1]))",Sin condición WITH CHECK
storage,objects,Owners can update item photos 13j4whn_0,✏️ MODIFICAR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN USANDO,"((bucket_id = 'item-photos'::text) AND ((auth.uid())::text = (regexp_match(name, '^item-photos/([^/]+)/'::text))[1]) AND (EXISTS ( SELECT 1
   FROM items
  WHERE (((items.id)::text = (regexp_match(objects.name, '^item-photos/[^/]+/([^_]+)_'::text))[1]) AND (items.owner_id = auth.uid())))))",Sin condición WITH CHECK
storage,objects,storage_avatars_owner_update 1oj01fe_0,✏️ MODIFICAR,authenticated,🔒 ACCESO RESTRINGIDO,✅ RESTRICCIÓN EN USANDO,((bucket_id = 'avatars'::text) AND ((auth.uid())::text = (storage.foldername(name))[2])),Sin condición WITH CHECK